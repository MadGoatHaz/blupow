BluPow Project Handover & WorkflowLast Updated: 2025-06-191. Project StatusCurrent State: STABLE - FOUNDATION COMPLETEThe BluPow integration has successfully moved past the initial environmental and connection hurdles. We have achieved a stable foundation upon which to build the full feature set.Accomplishments:Successful Connection: A persistent, robust Bluetooth LE connection to the target Renogy device (BT-TH-6A667ED4) has been established from within the Home Assistant environment.GATT Service Discovery: The complete service and characteristic map of the target device has been successfully discovered and documented in const.py.Live Data Reading: The integration can successfully read our first real piece of data: the device's "Model Number".Core HA Structure: All necessary components for a native HACS integration are in place, including the config flow, data update coordinator, and sensor platform.Branding: The project logo and naming are correctly configured to appear in the Home Assistant UI.Immediate Next Steps:Commit this stable codebase to a new GitHub repository.Begin implementing the logic to read the main data channels (using the Notify characteristic 0000ffd2-0000-1000-8000-00805f9b34fb).Add logic to parse the incoming data frames (likely Modbus) into meaningful values (voltage, current, etc.).Create sensor entities for each of these new data points.2. Development Workflow (Mandatory)To ensure stability and prevent errors, all development will strictly adhere to the following workflow:Discussion: All new features, changes, or bug fixes will first be discussed and agreed upon in our conversation.Full Code Generation: I will generate complete, self-contained code files for any changes. You will never be asked to manually edit, patch, or configure code within a file. The correct procedure is to replace the entire old file with the new version I provide.Isolated Testing: You will copy the new/updated files into the custom_components/blupow/ directory, restart Home Assistant, and perform the requested tests.Feedback Loop: You will provide the results of the test (including any logs if necessary). Based on this feedback, we will proceed to the next step or I will provide a new, corrected set of files.3. Core Rules & PrecautionsRULE: NO CORE FILE EDITS. I will never again ask you to edit any files outside of the custom_components/blupow/ directory, especially not core Home Assistant files like core.config_entries. This was a serious mistake and is now a hard rule for this project.RULE: CLEANUP IS KEY. When encountering persistent or unusual errors (like already_configured), the first step is always to safely delete the integration from the Home Assistant UI. If it cannot be deleted from the UI, we will use a safe diagnostic script that does not create a configuration entry.RULE: FULL RESTARTS. For changes to take effect reliably, a full restart of the Home Assistant container (docker compose down && docker compose up -d) is the required method. A simple UI restart is not always sufficient.4. Environment NotesThese are critical details about the successful development environment that should be preserved.Operating System: Ubuntu 24.04Home Assistant Installation: Docker ComposeKey docker-compose.yaml settings: The following settings for the homeassistant service are required for Bluetooth hardware access to function correctly in this environment:services:
  homeassistant:
    network_mode: host
    group_add:
      - '107'  # The GID of the 'bluetooth' group on the host
    volumes:
      - /home/madgoat/opt/homeassistant/config:/config
      - /run/dbus:/run/dbus:ro

